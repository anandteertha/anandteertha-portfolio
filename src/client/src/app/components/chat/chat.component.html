<div class="chat-widget">
  <!-- Chat Button -->
  <button 
    class="chat-button" 
    (click)="toggleChat()"
    [class.open]="isOpen"
    aria-label="Open chat assistant"
    title="Ask me about Anandteertha's career and education">
    <svg *ngIf="!isOpen" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM20 16H6L4 18V4H20V16Z" fill="currentColor"/>
      <path d="M7 9H17V11H7V9ZM7 12H15V14H7V12ZM7 6H17V8H7V6Z" fill="currentColor"/>
    </svg>
    <svg *ngIf="isOpen" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
    </svg>
  </button>

  <!-- Chat Window -->
  <div class="chat-window" [class.open]="isOpen" *ngIf="isOpen">
    <div class="chat-header">
      <div class="header-content">
        <div class="header-icon">ðŸ’¬</div>
        <div class="header-text">
          <h3>Career & Education Assistant</h3>
          <p>Ask me anything about Anandteertha</p>
        </div>
      </div>
      <button class="close-button" (click)="closeChat()" aria-label="Close chat">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="currentColor"/>
        </svg>
      </button>
    </div>

    <div class="chat-messages" #chatContainer>
      <div 
        *ngFor="let message of messages" 
        class="message"
        [class.user]="message.role === 'user'"
        [class.assistant]="message.role === 'assistant'">
        <div class="message-content">
          <div class="message-text" [innerHTML]="formatMessage(message.content)"></div>
          <div class="message-time">{{ formatTime(message.timestamp) }}</div>
        </div>
      </div>

      <div *ngIf="isLoading" class="message assistant">
        <div class="message-content">
          <div class="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <div class="chat-input-container">
      <div class="input-wrapper">
        <textarea
          #messageInput
          [(ngModel)]="currentMessage"
          (keydown)="onKeyPress($event)"
          (input)="autoResizeTextarea()"
          placeholder="Ask about career, education, or projects..."
          class="chat-input"
          rows="1"
          [disabled]="isLoading"></textarea>
        <button 
          class="send-button" 
          (click)="sendMessage()"
          [disabled]="!currentMessage.trim() || isLoading"
          aria-label="Send message">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2.01 21L23 12L2.01 3L2 10L17 12L2 14L2.01 21Z" fill="currentColor"/>
          </svg>
        </button>
      </div>
      <div *ngIf="error" class="error-message">{{ error }}</div>
    </div>
  </div>
</div>

